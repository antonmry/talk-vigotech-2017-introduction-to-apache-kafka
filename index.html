<!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><meta name="author" content="Antón R. Yuste - @antonmry - OptareSolutions &amp; VigoJUG" /><title>Introducción a Apache Kafka</title><meta content="yes" name="apple-mobile-web-app-capable" /><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style" /><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui" name="viewport" /><link href="reveal.js/css/reveal.css" rel="stylesheet" /><link rel="stylesheet" href="reveal.js/css/theme/summit.css" id="theme" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css" /><link href="reveal.js/lib/css/zenburn.css" rel="stylesheet" /><script>document.write( '<link rel="stylesheet" href="reveal.js/css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );</script><link rel="stylesheet" type="text/css" href="reveal.js/css/theme/asciinema-player.css" />
<link rel="stylesheet" type="text/css" href="reveal.js/css/theme/github-gist.css" />
<script src="reveal.js/css/theme/asciinema-player.js"></script>
<script>if (location.hostname === "localhost" || location.hostname === "127.0.0.1")
    document.write('<script src="http://'
    + (location.host || 'localhost').split(':')[0]
    + ':35729/livereload.js"></'
    + 'script>')</script></head><body><div class="reveal"><div class="slides"><section class="title" data-state="title"><h1>Introducción a Apache Kafka</h1><p class="author"><small>Antón R. Yuste - @antonmry - OptareSolutions &amp; VigoJUG</small></p></section><section id="e-ti-de-quen-ves-sendo" data-background-image="./images/costadamorte.jpg" data-background-size="cover"><h2>E ti, ¿de quen ves sendo?</h2>
<style>
.asciinema-terminal.font-medium {
  font-size: 16px;
}
</style>

<div class="pictureWrapper">
   <div class="picture"><img src="images/mini-me.png"></div>
</div>
<div class="listingblock"><div class="content"><pre class="highlight"><code class="groovy language-groovy">speaker = [
    name: 'Antón R. Yuste',
    company: 'Optare Solutions',
    role: 'Technical Director',
    twitter: '@antonmry',
    github: 'antonmry',
    extraDescription: ['VigoJUG co-organiser',
         '''Misc OSS contribs (Gradle plugins,
            docker images, SIP &amp; WebRTC...)''',
         'surfer wannabe',]
].each{ k, v -&gt; println "${k}:${v}" }</code></pre></div></div></section>
<section id="optare-solutions"><h2>Optare Solutions</h2><div class="imageblock" style=""><img src="./images/optare.jpg" alt="Optare" /></div></section>
<section id="frontend-vs-backend"><h2>Frontend vs. Backend</h2><div class="imageblock" style=""><img src="./images/front-back-end.png" alt="Frontend vs. Back-end" /></div></section>
<section id="microservices"><h2>Microservices</h2><div class="imageblock" style=""><img src="./images/microservices.gif" alt="Microservices" /></div></section>
<section><section id="apache-kafka"><h2>Apache Kafka</h2><div class="quoteblock"><blockquote><div class="paragraph"><p>Apache Kafka es un proyecto de intermediación de mensajes de código abierto desarrollado por la Apache Software Foundation escrito en Scala.</p></div></blockquote></div><div class="paragraph"><p>Fonte: wikipedia</p></div></section><section id="apache-kafka-2"><h2>Apache Kafka</h2><div class="quoteblock"><blockquote><div class="paragraph"><p>El proyecto tiene como objetivo proporcionar una plataforma unificada, de alto rendimiento y de baja latencia para la manipulación en tiempo real de fuentes de datos.</p></div></blockquote></div>
<div class="paragraph"><p>Fonte: wikipedia</p></div></section><section id="apache-kafka-3"><h2>Apache Kafka</h2><div class="quoteblock"><blockquote><div class="paragraph"><p>Puede verse como una cola de mensajes, bajo el patrón publicación-suscripción, masivamente escalable concebida como un registro de transacciones distribuidas, la que la vuelve atractiva para las infraestructuras de aplicaciones empresariales.</p></div></blockquote></div>
<div class="paragraph"><p>Fonte: wikipedia</p></div></section><section id="a-mia-definicin-caixas-mxicas"><h2>A miña definición: caixas máxicas</h2><div class="imageblock" style=""><img src="./images/caixones.jpg" alt="caixons" /></div></section></section>
<section><section id="uso"><h2>Uso</h2><div class="imageblock" style=""><img src="./images/Before_Kafka.png" alt="Spaguetti Architecture" /></div></section><section id="separar-os-servicios"><h2>Separar os servicios</h2><div class="imageblock" style=""><img src="./images/With_KAFKA.png" alt="Kafka definition of services" /></div></section><section id="con-kafka"><h2>Con Kafka</h2><div class="imageblock" style=""><img src="./images/After_KAFKA.png" alt="Architecture with Kafka" /></div></section><section id="fonte"><h2>Fonte</h2><div class="paragraph"><p><a href="https://www.confluent.io/blog/stream-data-platform-1/">Putting Apache Kafka To Use: A Practical Guide to Building a Streaming Platform</a> - Confluent</p></div></section></section>
<section><section id="arquitectura"><h2>Arquitectura</h2><div class="imageblock" style=""><img src="./images/architecture.png" alt="Apache Kafka Architecture" /></div></section><section id="topic"><h2>Topic</h2><div class="imageblock" style=""><img src="./images/topic.png" alt="Apache Kafka Topic" /></div></section><section id="replication"><h2>Replication</h2><div class="imageblock" style=""><img src="./images/replication.png" alt="Apache Kafka Replication" /></div></section><section id="fonte-2"><h2>Fonte</h2><div class="paragraph"><p><a href="http://kth.diva-portal.org/smash/get/diva2:813137/FULLTEXT01.pdf">Message-oriented Middleware for Scalable Data Analytics Architectures (NICOLAS NANNONI)</a></p></div></section></section>
<section><section id="rendemento"><h2>Rendemento</h2><div class="imageblock" style=""><img src="./images/kafka-performance.png" alt="Apache Kafka Performance" /></div></section><section id="latencia"><h2>Latencia</h2><div class="imageblock" style=""><img src="./images/latency.jpg" alt="Apache Kafka Latencia" /></div></section></section>
<section id="conectores"><h2>Conectores</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:50%" /><col style="width:50%" /></colgroup><tbody><tr><td class="tableblock halign-left valign-top"><div><div class="ulist"><ul><li><p>Java</p></li><li><p>C/C++</p></li><li><p>Python</p></li><li><p>Go (AKA golang)</p></li><li><p>Erlang</p></li><li><p>.NET</p></li><li><p>Clojure</p></li><li><p>Ruby</p></li><li><p>Node.js</p></li></ul></div></div></td><td class="tableblock halign-left valign-top"><div><div class="ulist"><ul><li><p>Proxy (HTTP REST, etc)</p></li><li><p>Perl</p></li><li><p>stdin/stdout</p></li><li><p>PHP</p></li><li><p>Rust</p></li><li><p>Alternative Java</p></li><li><p>Storm</p></li><li><p>Scala DSL</p></li><li><p>Clojure</p></li></ul></div></div></td></tr></tbody></table></section>
<section><section id="exemplo-refubot"><h2>Exemplo: refubot</h2><div class="imageblock" style=""><img src="./images/refubot.png" alt="Refubot con Apache Kafka" /></div></section><section id="funcionou"><h2>¡Funcionou!</h2><div class="imageblock" style=""><img src="./images/refubot-presentacion.jpg" alt="Presentacion Refubot" /></div></section></section>
<section><section id="casos-de-uso"><h2>Casos de uso</h2><div class="paragraph"><p>Algúns exemplos habituais pero é unha ferramenta que soporta moitos usos.</p></div></section><section id="messaging"><h2>Messaging</h2><div class="ulist"><ul><li><p>Permite desaclopar sistemas tradicionais.</p></li><li><p>Tamén para coordinar sistemas distribuidos.</p></li><li><p>Exemplos: refubot, Bluemix, LivePerson.</p></li></ul></div></section><section id="website-activity-tracking"><h2>Website Activity Tracking</h2><div class="ulist"><ul><li><p>O volumen de datos xerados polos usuarios é moi alto.</p></li><li><p>Ten moitos usos: estadísticas, monitoreo, seguridade, etc.</p></li><li><p>Nalgún casos é preciso ter acceso a información en tempo real con accións immediatas.</p></li><li><p><a href="https://engineering.linkedin.com/blog/2016/04/kafka-ecosystem-at-linkedin">Linkedin</a>, <a href="https://blog.twitter.com/engineering/en_us/a/2015/handling-five-billion-sessions-a-day-in-real-time.html">Twitter</a></p></li></ul></div></section><section id="mtricas"><h2>Métricas</h2><div class="ulist"><ul><li><p>O sistema que as recibe pode non ser capaz de procesar todo o tráfico no momento que se produce: precisamos un "buffer".</p></li><li><p>A información tense que persistir, incluso si algún dos servidores do "buffer" se cae.</p></li><li><p><a href="https://yahooeng.tumblr.com/post/109994930921/kafka-yahoo">Yahoo</a>, <a href="https://medium.com/netflix-techblog/kafka-inside-keystone-pipeline-dd5aeabaf6bb">Netflix</a>, <a href="https://eng.uber.com/tech-stack-part-two/">Uber</a>, R-Cable Smart Home.</p></li></ul></div></section><section id="agregacin-de-logs"><h2>Agregación de Logs</h2><div class="ulist"><ul><li><p>Sistema central para almacenar os logs de diferentes fontes antes de ser procesados.</p></li><li><p>Hai ferramentas específicas pero Kafka ten menor latencia, o que nalgúns casos pode ser moi interesantes.</p></li><li><p>Integracións con ELK.</p></li><li><p><a href="https://medium.com/@Pinterest_Engineering/introducing-pinterest-secor-e868d9400bec">Pinterest</a>, <a href="https://www.meetup.com/stockholm-hug/events/121628932/">Spotify</a>, trivago, cloudfare, graylog2, shopify</p></li></ul></div></section></section>
<section><section id="demo"><h2>Demo</h2><div class="imageblock" style=""><img src="./images/demo.gif" alt="Demo" /></div></section><section id="posta-en-marcha-e-proba"><h2>Posta en marcha e proba</h2><div class="listingblock"><div class="content"><pre class="highlight"><code class="bash language-bash">docker run -p 2181:2181 -p 9092:9092 --name kafka --hostname kafka --env ADVERTISED_HOST=kafka --env ADVERTISED_PORT=9092 spotify/kafka

docker exec -it kafka /bin/bash

$KAFKA_HOME/bin/kafka-topics.sh --create --zookeeper localhost:2181 --replication-factor 1 --partitions 1 --topic example

$KAFKA_HOME/bin/kafka-topics.sh --list --zookeeper localhost:2181

$KAFKA_HOME/bin/kafka-console-producer.sh --broker-list kafka:9092 --topic example

$KAFKA_HOME/bin/kafka-console-consumer.sh --bootstrap-server kafka:9092 --topic example --from-beginning</code></pre></div></div></section><section id="cliente-python"><h2>Cliente Python</h2><div class="listingblock"><div class="content"><pre class="highlight"><code class="bash language-bash">apt-get install python3 python3-dev python3-pip vim
pip3 install kafka-python</code></pre></div></div>
<div class="listingblock"><div class="content"><pre class="highlight"><code class="python language-python">from kafka import KafkaProducer

producer = KafkaProducer(bootstrap_servers='kafka:9092')
producer.send('example', b'hello from python')</code></pre></div></div></section></section>
<section><section id="kafka-streams"><h2>Kafka Streams</h2></section><section id="a-comunicacin-tradicional-sistemas-acoplados"><h2>A comunicación tradicional (sistemas acoplados)</h2><div class="imageblock" style=""><img src="./images/before_stream.png" alt="Fullfilment" /></div></section><section id="basada-en-eventos"><h2>Basada en eventos</h2><div class="imageblock" style=""><img src="./images/with_stream.png" alt="Fullfilment Events Based" /></div></section><section id="fluxo-de-negocio-con-streams"><h2>Fluxo de negocio con streams</h2><div class="imageblock" style=""><img src="./images/kafka_stream.png" alt="Streams with Kafka" /></div></section><section id="streams"><h2>Streams</h2><div class="listingblock"><div class="content"><pre class="highlight"><code class="java language-java">KStream&lt;String,Purchase&gt; purchaseKStream =
kStreamBuilder.stream(stringSerde,purchaseSerde,"orders")
.mapValues(p -&gt; Purchase.builder(p).maskCreditCard().build())
.to(stringSerde, purchasePatternSerde, "shipments");</code></pre></div></div></section><section id="fonte-3"><h2>Fonte</h2><div class="paragraph"><p><a href="https://www.confluent.io/blog/build-services-backbone-events/">Build Services on a Backbone of Events</a> - Confluent</p></div></section></section>
<section id="resumo"><h2>Resumo</h2><div class="ulist"><ul><li><p>Apache Kafka é doado e aporta vantaxes dende o primeiro minuto.</p></li><li><p>Kafka Streams habilitan unha nova arquitectura que terá moito éxito.</p></li><li><p>Moi útil para temas de IoT.</p></li></ul></div></section>
<section id="gracias" data-background-image="./images/questions.jpg" data-background-size="cover"><h2>¡Gracias!</h2>
<div class="ulist"><ul><li><p>Slides: <a href="https://antonmry.github.io/talk-vigotech-2017-introduction-to-apache-kafka" class="bare">https://antonmry.github.io/talk-vigotech-2017-introduction-to-apache-kafka</a></p></li><li><p>Código: <a href="https://github.com/antonmry/talk-vigotech-2017-introduction-to-apache-kafka" class="bare">https://github.com/antonmry/talk-vigotech-2017-introduction-to-apache-kafka</a></p></li><li><p>Documentación Apache Kafka: <a href="https://kafka.apache.org/" class="bare">https://kafka.apache.org/</a></p></li><li><p>Tamén podes preguntarme en twitter: <a href="http://twitter.com/antonmry">@antonmry</a></p></li></ul></div></section></div></div><script src="reveal.js/lib/js/head.min.js"></script><script src="reveal.js/js/reveal.js"></script><script>// See https://github.com/hakimel/reveal.js#configuration for a full list of configuration options
Reveal.initialize({
  // Display controls in the bottom right corner
  controls: true,
  // Display a presentation progress bar
  progress: true,
  // Display the page number of the current slide
  slideNumber: true,
  // Push each slide change to the browser history
  history: true,
  // Enable keyboard shortcuts for navigation
  keyboard: true,
  // Enable the slide overview mode
  overview: true,
  // Vertical centering of slides
  center: true,
  // Enables touch navigation on devices with touch input
  touch: true,
  // Loop the presentation
  loop: false,
  // Change the presentation direction to be RTL
  rtl: false,
  // Turns fragments on and off globally
  fragments: true,
  // Flags if the presentation is running in an embedded mode,
  // i.e. contained within a limited portion of the screen
  embedded: false,
  // Number of milliseconds between automatically proceeding to the
  // next slide, disabled when set to 0, this value can be overwritten
  // by using a data-autoslide attribute on your slides
  autoSlide: 0,
  // Stop auto-sliding after user input
  autoSlideStoppable: true,
  // Enable slide navigation via mouse wheel
  mouseWheel: false,
  // Hides the address bar on mobile devices
  hideAddressBar: true,
  // Opens links in an iframe preview overlay
  previewLinks: false,
  // Theme (e.g., beige, black, league, night, serif, simple, sky, solarized, white)
  // NOTE setting the theme in the config no longer works in reveal.js 3.x
  //theme: Reveal.getQueryHash().theme || 'summit',
  // Transition style (e.g., none, fade, slide, convex, concave, zoom)
  transition: Reveal.getQueryHash().transition || 'linear',
  // Transition speed (e.g., default, fast, slow)
  transitionSpeed: 'default',
  // Transition style for full page slide backgrounds (e.g., none, fade, slide, convex, concave, zoom)
  backgroundTransition: 'fade',
  // Number of slides away from the current that are visible
  viewDistance: 3,
  // Parallax background image (e.g., "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'")
  parallaxBackgroundImage: '',
  // Parallax background size in CSS syntax (e.g., "2100px 900px")
  parallaxBackgroundSize: '',

  // The "normal" size of the presentation, aspect ratio will be preserved
  // when the presentation is scaled to fit different resolutions. Can be
  // specified using percentage units.
  width: 960,
  height: 700,

  // Factor of the display size that should remain empty around the content
  margin: 0.1,

  // Bounds for smallest/largest possible scale to apply to content
  minScale: 0.2,
  maxScale: 1.5,

  // Optional libraries used to extend on reveal.js
  dependencies: [
      { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
      { src: 'reveal.js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
      { src: 'reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
      { src: 'reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
      { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
      { src: 'reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
  ]
});</script><div id="footer">
  <div style="width:100%">
     <div style="display:inline; vertical-align: middle; line-height: 40px;">2017 - VigoTech - @antonmry - Introducción a Apache Kafka</div>
     <!--<div style="display:inline; position:absolute; right: 50px;"><img src="images/vigojug-logo-min.png"></div> -->
  </div>
</div>

<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-57796882-1', 'auto');
    ga('send', 'pageview');
</script></body></html>